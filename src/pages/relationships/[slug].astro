---
import BaseLayout from '../../layouts/BaseLayout.astro';

interface RelationshipModule {
    default: any;
    compiledContent(): string;
}

export async function getStaticPaths() {
    const relationshipFiles = Object.entries(import.meta.glob<RelationshipModule>('../../content/relationships/*.md', { eager: true }));

    return relationshipFiles.map(([path, relationship]) => {
        const slug = path.split('/').pop()?.replace('.md', '') || '';
        return {
            params: { slug },
            props: { relationship, slug },
        };
    });
}

const { relationship, slug } = Astro.props as { relationship: RelationshipModule; slug: string };

// Get the full compiled markdown content
const fullContent = await relationship.compiledContent();

// Generate a title from the slug
const title = slug.split('_').map(word => 
    word.charAt(0).toUpperCase() + word.slice(1)
).join(' ');
---

<BaseLayout title={`${title} - Distant Worlds Relationships`}>
    <style>
        .relationship-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .relationship-content {
            background: rgba(22, 27, 34, 0.4);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(48, 54, 61, 0.6);
            border-radius: 20px;
            padding: 2.5rem;
            color: white;
            line-height: 1.6;
        }
        
        .back-button {
            position: fixed;
            top: 20px;
            left: 2rem;
            background: rgba(22, 27, 34, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(48, 54, 61, 0.6);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .back-button:hover {
            background: rgba(22, 27, 34, 0.95);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .relationship-content h1 {
            color: #00d4ff;
            font-size: 2.5em;
            margin-bottom: 1.5rem;
            text-align: center;
        }
        
        .relationship-content h2 {
            color: #9333ea;
            font-size: 1.8em;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(147, 51, 234, 0.3);
            padding-bottom: 0.5rem;
        }
        
        .relationship-content h3 {
            color: #ff8800;
            font-size: 1.4em;
            margin-top: 1.5rem;
            margin-bottom: 0.8rem;
        }
        
        .relationship-content p {
            margin-bottom: 1.2rem;
        }
        
        .relationship-content strong {
            color: #00ff88;
        }
        
        @media (max-width: 768px) {
            .relationship-container {
                padding: 1rem;
            }
            
            .relationship-content {
                padding: 1.5rem;
            }
            
            .relationship-content h1 {
                font-size: 2em;
            }
        }
    </style>

    <a href="/" class="back-button">‚Üê Back to Collection</a>

    <div class="relationship-container">
        <div class="relationship-content">
            <div set:html={fullContent} />
        </div>
    </div>
</BaseLayout> 